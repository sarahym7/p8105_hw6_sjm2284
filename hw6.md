HW6
================
Sarahy Martinez
2024-12-01

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(broom)
set.seed(1)
```

\#Problem 1

``` r
weather_df = 
  rnoaa::meteo_pull_monitors(
    c("USW00094728"),
    var = c("PRCP", "TMIN", "TMAX"), 
    date_min = "2017-01-01",
    date_max = "2017-12-31") %>%
  mutate(
    name = recode(id, USW00094728 = "CentralPark_NY"),
    tmin = tmin / 10,
    tmax = tmax / 10) %>%
  select(name, id, everything())
```

# Problem 2

## Problem 2A

``` r
#reading in Washington post data 

homicide_raw_data = read.csv("./homicide-data.csv")

homicide = homicide_raw_data %>% 
  unite(city_state, city, state, sep = ",") %>% 
  mutate(disposition_case = case_when( disposition == "Closed without arrest"~ "unresolved",
                                  disposition == "Closed by arrest" ~ "resolved",
                                  disposition == "Open/No arrest" ~ "unresolved")) %>%
 filter(!city_state %in% c("Dallas,TX", "Phoenix,AZ", "Kansas City,MO", "Tulsa,AL")) %>% 
  filter(victim_race %in% c("White", "Black")) %>% 
  mutate(victim_age = as.numeric(victim_age)) %>% 
  mutate(resolved = as.numeric(disposition_case == "resolved"))
```

    ## Warning: There was 1 warning in `mutate()`.
    ## ℹ In argument: `victim_age = as.numeric(victim_age)`.
    ## Caused by warning:
    ## ! NAs introduced by coercion

## Problem 2B

Using these data, we can fit a logistic regression for the binary
“resolved” outcome and victim demographics as predictors. This uses the
glm function with the family specified to account for the non-Gaussian
outcome distribution.

``` r
baltimore_df = 
  homicide %>% 
  filter(city_state == "Baltimore,MD") %>% 
  mutate(
    resolved = as.numeric(disposition_case == "resolved"),
    victim_age = as.numeric(victim_age),
    victim_race = fct_relevel(victim_race, "White")) %>% 
  select(resolved,victim_age, victim_race, victim_sex)

# applying the glm function
fit_logistic = 
  baltimore_df %>% 
  glm(resolved ~ victim_age + victim_race + victim_sex, data = ., family = binomial()) 

#using the broom tidy function and estimate the odds ratio and confidence interval

Balt_fit_logistic = 
  broom::tidy(fit_logistic, conf.int = TRUE) %>% #conf.int function used to calculate the CI
  mutate(
    OR = exp(estimate),
    OR_conf.low = exp(conf.low),
    OR_conf.high = exp(conf.high)
  ) %>%
  select (OR, OR_conf.low, OR_conf.high) %>% 
  rename(low = "OR_conf.low",
          high = "OR_conf.high") 

Balt_fit_logistic %>% knitr::kable(digits = 3)
```

|    OR |   low |  high |
|------:|------:|------:|
| 3.164 | 1.998 | 5.057 |
| 0.993 | 0.987 | 1.000 |
| 0.431 | 0.305 | 0.606 |
| 0.426 | 0.324 | 0.558 |

## Problem 2C

``` r
# Nest data by city
nested_data <- homicide %>%
  group_by(city_state) %>%
  nest()

# Verify the nested data to ensure the resolved variable is included
nested_data %>% slice(1) %>% pull(data) %>% str()
```

    ## List of 47
    ##  $ : tibble [178 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:178] "Alb-000003" "Alb-000005" "Alb-000006" "Alb-000009" ...
    ##   ..$ reported_date   : int [1:178] 20100601 20100102 20100126 20100130 20100218 20100308 20100323 20100402 20100423 20100423 ...
    ##   ..$ victim_last     : chr [1:178] "SATTERFIELD" "MULA" "BOOK" "MARTIN-LEYVA" ...
    ##   ..$ victim_first    : chr [1:178] "VIVIANA" "VIVIAN" "GERALDINE" "GUSTAVO" ...
    ##   ..$ victim_race     : chr [1:178] "White" "White" "White" "White" ...
    ##   ..$ victim_age      : num [1:178] 15 72 91 56 NA 43 52 22 15 25 ...
    ##   ..$ victim_sex      : chr [1:178] "Female" "Female" "Female" "Male" ...
    ##   ..$ lat             : num [1:178] 35.1 35.1 35.2 35.1 35.1 ...
    ##   ..$ lon             : num [1:178] -107 -107 -107 -107 -107 ...
    ##   ..$ disposition     : chr [1:178] "Closed without arrest" "Closed without arrest" "Open/No arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:178] "unresolved" "unresolved" "unresolved" "unresolved" ...
    ##   ..$ resolved        : num [1:178] 0 0 0 0 0 1 1 1 1 1 ...
    ##  $ : tibble [945 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:945] "Atl-000756" "Atl-000757" "Atl-000759" "Atl-000760" ...
    ##   ..$ reported_date   : int [1:945] 20070110 20070110 20070114 20070120 20070128 20070204 20070215 20070225 20070225 20070225 ...
    ##   ..$ victim_last     : chr [1:945] "BIRDSONG" "REED" "SPENCER" "POPE" ...
    ##   ..$ victim_first    : chr [1:945] "ERNEST" "MICHAEL" "CHARLES" "LUKE" ...
    ##   ..$ victim_race     : chr [1:945] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:945] 29 29 26 75 22 40 1 25 25 46 ...
    ##   ..$ victim_sex      : chr [1:945] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:945] 33.7 33.8 33.6 33.7 33.7 ...
    ##   ..$ lon             : num [1:945] -84.4 -84.5 -84.4 -84.4 -84.5 ...
    ##   ..$ disposition     : chr [1:945] "Closed by arrest" "Closed by arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:945] "resolved" "resolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:945] 1 1 1 0 0 1 1 1 0 1 ...
    ##  $ : tibble [2,753 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:2753] "Bal-001607" "Bal-001608" "Bal-001609" "Bal-001610" ...
    ##   ..$ reported_date   : int [1:2753] 20070101 20070102 20070105 20070105 20070106 20070106 20070107 20070108 20070108 20070108 ...
    ##   ..$ victim_last     : chr [1:2753] "NELSON" "GOLF" "MACKENNEY" "CANUPP" ...
    ##   ..$ victim_first    : chr [1:2753] "LEON" "EDDIE" "THOMAS JOSEPH" "EDWARD LEE" ...
    ##   ..$ victim_race     : chr [1:2753] "Black" "Black" "Black" "White" ...
    ##   ..$ victim_age      : num [1:2753] 17 26 21 61 46 27 21 16 21 44 ...
    ##   ..$ victim_sex      : chr [1:2753] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:2753] 39.3 39.3 39.4 39.2 39.4 ...
    ##   ..$ lon             : num [1:2753] -76.7 -76.7 -76.6 -76.6 -76.6 ...
    ##   ..$ disposition     : chr [1:2753] "Open/No arrest" "Open/No arrest" "Open/No arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:2753] "unresolved" "unresolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:2753] 0 0 0 1 1 1 1 1 1 1 ...
    ##  $ : tibble [410 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:410] "Bat-000001" "Bat-000002" "Bat-000003" "Bat-000004" ...
    ##   ..$ reported_date   : int [1:410] 20110103 20110212 20110212 20110213 20110226 20110228 20110301 20110104 20110301 20110401 ...
    ##   ..$ victim_last     : chr [1:410] "GREVIOUS" "ERVIN" "WATSON" "WILLIAMS" ...
    ##   ..$ victim_first    : chr [1:410] "TERRANCE" "CALVIN" "BRANDON" "CHRISTOPHER" ...
    ##   ..$ victim_race     : chr [1:410] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:410] 38 46 30 14 21 25 23 27 63 38 ...
    ##   ..$ victim_sex      : chr [1:410] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:410] 30.5 30.5 30.5 30.5 30.5 ...
    ##   ..$ lon             : num [1:410] -91.2 -91.1 -91.1 -91.1 -91.1 ...
    ##   ..$ disposition     : chr [1:410] "Open/No arrest" "Open/No arrest" "Open/No arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:410] "unresolved" "unresolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:410] 0 0 0 1 0 1 1 1 0 1 ...
    ##  $ : tibble [771 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:771] "Bir-000001" "Bir-000003" "Bir-000004" "Bir-000005" ...
    ##   ..$ reported_date   : int [1:771] 20130605 20131118 20130824 20160429 20140502 20170925 20091023 20121210 20160223 20140309 ...
    ##   ..$ victim_last     : chr [1:771] "WHITTSETT" "TOWNS" "SILVER" "BILLINGSLEY" ...
    ##   ..$ victim_first    : chr [1:771] "MANQUEL" "TERRY" "CHANCE" "RONALD" ...
    ##   ..$ victim_race     : chr [1:771] "Black" "Black" "White" "Black" ...
    ##   ..$ victim_age      : num [1:771] 37 37 26 35 46 29 33 34 41 23 ...
    ##   ..$ victim_sex      : chr [1:771] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:771] 33.4 33.4 33.4 33.4 33.4 ...
    ##   ..$ lon             : num [1:771] -86.9 -86.9 -86.7 -86.9 -86.9 ...
    ##   ..$ disposition     : chr [1:771] "Open/No arrest" "Closed by arrest" "Open/No arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:771] "unresolved" "resolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:771] 0 1 0 1 0 1 0 0 0 1 ...
    ##  $ : tibble [492 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:492] "Bos-000001" "Bos-000003" "Bos-000004" "Bos-000005" ...
    ##   ..$ reported_date   : int [1:492] 20131029 20160113 20160127 20141112 20160204 20131112 20160221 20160321 20160322 20160327 ...
    ##   ..$ victim_last     : chr [1:492] "MAYS-JESURUM" "JACQUET" "SEALEY" "WESTON" ...
    ##   ..$ victim_first    : chr [1:492] "TROI" "EDEN" "ALVIN" "RONALD" ...
    ##   ..$ victim_race     : chr [1:492] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:492] 26 30 19 76 22 4 15 29 32 26 ...
    ##   ..$ victim_sex      : chr [1:492] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:492] 42.3 42.3 42.3 42.3 42.3 ...
    ##   ..$ lon             : num [1:492] -71.1 -71.1 -71.1 -71.1 -71.1 ...
    ##   ..$ disposition     : chr [1:492] "Open/No arrest" "Open/No arrest" "Open/No arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:492] "unresolved" "unresolved" "unresolved" "unresolved" ...
    ##   ..$ resolved        : num [1:492] 0 0 0 0 0 0 1 1 1 1 ...
    ##  $ : tibble [479 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:479] "Buf-000182" "Buf-000183" "Buf-000184" "Buf-000185" ...
    ##   ..$ reported_date   : int [1:479] 20070101 20070102 20070107 20070118 20070203 20070213 20070218 20070224 20070304 20070323 ...
    ##   ..$ victim_last     : chr [1:479] "AKIN" "CURRY" "COOK" "RAZICK" ...
    ##   ..$ victim_first    : chr [1:479] "MARQUITA" "DAVID" "ERIC" "KAMAL" ...
    ##   ..$ victim_race     : chr [1:479] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:479] 18 17 20 22 38 18 23 32 26 30 ...
    ##   ..$ victim_sex      : chr [1:479] "Female" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:479] 42.9 42.9 42.9 42.9 42.9 ...
    ##   ..$ lon             : num [1:479] -78.9 -78.8 -78.9 -78.9 -78.8 ...
    ##   ..$ disposition     : chr [1:479] "Open/No arrest" "Open/No arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:479] "unresolved" "unresolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:479] 0 0 1 1 1 0 1 1 0 1 ...
    ##  $ : tibble [584 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:584] "Cha-000170" "Cha-000171" "Cha-000172" "Cha-000173" ...
    ##   ..$ reported_date   : int [1:584] 20070103 20070112 20070121 20070122 20070209 20070218 20070223 20070307 20070310 20070313 ...
    ##   ..$ victim_last     : chr [1:584] "GREEN" "HODGE" "DIAL" "TAYLOR" ...
    ##   ..$ victim_first    : chr [1:584] "EVA" "LEROY" "KEYON" "ROBERT" ...
    ##   ..$ victim_race     : chr [1:584] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:584] 63 65 17 55 21 17 37 31 28 20 ...
    ##   ..$ victim_sex      : chr [1:584] "Female" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:584] 35.2 35.3 35.3 35.2 35.2 ...
    ##   ..$ lon             : num [1:584] -80.8 -80.8 -80.9 -80.9 -80.8 ...
    ##   ..$ disposition     : chr [1:584] "Closed by arrest" "Closed by arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:584] "resolved" "resolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:584] 1 1 1 1 1 0 1 1 1 0 ...
    ##  $ : tibble [4,507 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:4507] "Chi-003284" "Chi-003285" "Chi-003286" "Chi-003288" ...
    ##   ..$ reported_date   : int [1:4507] 20070101 20070101 20070101 20070102 20070104 20070104 20070108 20070111 20070112 20070117 ...
    ##   ..$ victim_last     : chr [1:4507] "THOMAS" "ALLEN" "HALL" "ROOT" ...
    ##   ..$ victim_first    : chr [1:4507] "LEON" "MARIO" "CHALLAH" "FRANK" ...
    ##   ..$ victim_race     : chr [1:4507] "Black" "Black" "Black" "White" ...
    ##   ..$ victim_age      : num [1:4507] 36 31 21 34 37 31 38 29 31 24 ...
    ##   ..$ victim_sex      : chr [1:4507] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:4507] 41.8 41.9 41.8 41.9 41.9 ...
    ##   ..$ lon             : num [1:4507] -87.7 -87.7 -87.6 -87.6 -87.7 ...
    ##   ..$ disposition     : chr [1:4507] "Closed by arrest" "Closed without arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:4507] "resolved" "unresolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:4507] 1 0 1 1 0 0 0 1 0 0 ...
    ##  $ : tibble [679 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:679] "Cin-000440" "Cin-000441" "Cin-000442" "Cin-000443" ...
    ##   ..$ reported_date   : int [1:679] 20070102 20070104 20070105 20070114 20070114 20070116 20070102 20070127 20070129 20070130 ...
    ##   ..$ victim_last     : chr [1:679] "BIAS" "ENTZMINGER" "WOLFE" "MYERS" ...
    ##   ..$ victim_first    : chr [1:679] "ERICA" "MONTE   II" "PAULA" "DASHAWN" ...
    ##   ..$ victim_race     : chr [1:679] "Black" "Black" "White" "Black" ...
    ##   ..$ victim_age      : num [1:679] 26 21 47 14 26 21 0 26 51 24 ...
    ##   ..$ victim_sex      : chr [1:679] "Female" "Male" "Female" "Male" ...
    ##   ..$ lat             : num [1:679] 39.1 39.1 39.1 39.1 39.1 ...
    ##   ..$ lon             : num [1:679] -84.5 -84.5 -84.5 -84.5 -84.5 ...
    ##   ..$ disposition     : chr [1:679] "Closed without arrest" "Closed by arrest" "Open/No arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:679] "unresolved" "resolved" "unresolved" "unresolved" ...
    ##   ..$ resolved        : num [1:679] 0 1 0 0 0 0 1 0 1 0 ...
    ##  $ : tibble [1,026 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:1026] "Col-000001" "Col-000002" "Col-000003" "Col-000004" ...
    ##   ..$ reported_date   : int [1:1026] 20160102 20160104 20160104 20150106 20160106 20160112 20160112 20160112 20160117 20160117 ...
    ##   ..$ victim_last     : chr [1:1026] "FRUM" "POLLARD" "KAPLAN" "DIAWARA" ...
    ##   ..$ victim_first    : chr [1:1026] "JUDITH" "BRANDON" "LEONID" "ABOUBAKARY" ...
    ##   ..$ victim_race     : chr [1:1026] "White" "Black" "White" "Black" ...
    ##   ..$ victim_age      : num [1:1026] 59 21 51 15 30 32 10 7 21 45 ...
    ##   ..$ victim_sex      : chr [1:1026] "Female" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:1026] 40 40 39.9 40.1 40 ...
    ##   ..$ lon             : num [1:1026] -82.9 -83 -82.8 -83 -83 ...
    ##   ..$ disposition     : chr [1:1026] "Open/No arrest" "Closed by arrest" "Open/No arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:1026] "unresolved" "resolved" "unresolved" "unresolved" ...
    ##   ..$ resolved        : num [1:1026] 0 1 0 0 0 1 1 1 1 1 ...
    ##  $ : tibble [208 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:208] "Den-000001" "Den-000004" "Den-000005" "Den-000007" ...
    ##   ..$ reported_date   : int [1:208] 20100101 20100111 20100111 20100325 20100507 20100514 20100613 20100712 20100712 20100713 ...
    ##   ..$ victim_last     : chr [1:208] "HOWARD-CROSTHWAIT" "LEE" "FRANKLIN" "WESTENDORF" ...
    ##   ..$ victim_first    : chr [1:208] "ANTHONY" "DESHON" "LONELL" "ROSE" ...
    ##   ..$ victim_race     : chr [1:208] "White" "Black" "Black" "White" ...
    ##   ..$ victim_age      : num [1:208] 38 19 21 30 83 0 73 17 21 40 ...
    ##   ..$ victim_sex      : chr [1:208] "Male" "Male" "Male" "Female" ...
    ##   ..$ lat             : num [1:208] 39.7 39.8 39.8 39.6 39.7 ...
    ##   ..$ lon             : num [1:208] -105 -105 -105 -105 -105 ...
    ##   ..$ disposition     : chr [1:208] "Closed without arrest" "Open/No arrest" "Open/No arrest" "Closed without arrest" ...
    ##   ..$ disposition_case: chr [1:208] "unresolved" "unresolved" "unresolved" "unresolved" ...
    ##   ..$ resolved        : num [1:208] 0 0 0 0 1 1 0 1 0 0 ...
    ##  $ : tibble [2,457 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:2457] "Det-000001" "Det-000002" "Det-000003" "Det-000004" ...
    ##   ..$ reported_date   : int [1:2457] 20120518 20150828 20150412 20170428 20170517 20170520 20170529 20170715 20170901 20170806 ...
    ##   ..$ victim_last     : chr [1:2457] "WOODWARD" "WILLIAMS" "JACKSON" "JACKSON" ...
    ##   ..$ victim_first    : chr [1:2457] "LAWRENCE" "TAVION" "RODRICK" "VICTORIA" ...
    ##   ..$ victim_race     : chr [1:2457] "White" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:2457] 60 20 30 24 33 26 28 33 28 35 ...
    ##   ..$ victim_sex      : chr [1:2457] "Male" "Male" "Male" "Female" ...
    ##   ..$ lat             : num [1:2457] 42.3 42.4 42.3 42.4 42.4 ...
    ##   ..$ lon             : num [1:2457] -83.2 -83 -83.2 -83 -82.9 ...
    ##   ..$ disposition     : chr [1:2457] "Closed by arrest" "Open/No arrest" "Open/No arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:2457] "resolved" "unresolved" "unresolved" "unresolved" ...
    ##   ..$ resolved        : num [1:2457] 1 0 0 0 1 0 0 1 0 1 ...
    ##  $ : tibble [230 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:230] "Dur-000189" "Dur-000190" "Dur-000191" "Dur-000192" ...
    ##   ..$ reported_date   : int [1:230] 20070104 20070302 20070321 20070325 20070408 20070507 20070625 20070626 20070701 20070801 ...
    ##   ..$ victim_last     : chr [1:230] "SMITH" "CATES" "Unknown" "Unknown" ...
    ##   ..$ victim_first    : chr [1:230] "DENITA" "DAVID" "Unknown" "Unknown" ...
    ##   ..$ victim_race     : chr [1:230] "Black" "White" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:230] 25 62 0 14 49 19 15 39 26 25 ...
    ##   ..$ victim_sex      : chr [1:230] "Female" "Male" "Male" "Female" ...
    ##   ..$ lat             : num [1:230] 35.9 36 36 36 36 ...
    ##   ..$ lon             : num [1:230] -78.9 -78.9 -78.9 -78.9 -78.9 ...
    ##   ..$ disposition     : chr [1:230] "Closed by arrest" "Closed by arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:230] "resolved" "resolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:230] 1 1 1 1 0 1 1 0 1 1 ...
    ##  $ : tibble [383 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:383] "For-000053" "For-000054" "For-000055" "For-000057" ...
    ##   ..$ reported_date   : int [1:383] 20070110 20070117 20070117 20070304 20070309 20070317 20070318 20070321 20070405 20070408 ...
    ##   ..$ victim_last     : chr [1:383] "CHOPP" "WILSON" "DAVIS" "BUCK" ...
    ##   ..$ victim_first    : chr [1:383] "SAMMIEN" "BRIAN DEMARIO" "NICHOLAS RISHAWN" "SUSAN L" ...
    ##   ..$ victim_race     : chr [1:383] "Black" "Black" "Black" "White" ...
    ##   ..$ victim_age      : num [1:383] 22 22 20 49 21 22 24 46 21 20 ...
    ##   ..$ victim_sex      : chr [1:383] "Male" "Male" "Male" "Female" ...
    ##   ..$ lat             : num [1:383] 32.7 32.7 32.7 32.7 32.6 ...
    ##   ..$ lon             : num [1:383] -97.3 -97.3 -97.3 -97.4 -97.3 ...
    ##   ..$ disposition     : chr [1:383] "Closed without arrest" "Closed by arrest" "Closed by arrest" "Closed without arrest" ...
    ##   ..$ disposition_case: chr [1:383] "unresolved" "resolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:383] 0 1 1 0 0 1 1 0 0 0 ...
    ##  $ : tibble [210 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:210] "Fre-000003" "Fre-000004" "Fre-000007" "Fre-000009" ...
    ##   ..$ reported_date   : int [1:210] 20070403 20070406 20070507 20070520 20070527 20070124 20070617 20070620 20070620 20070626 ...
    ##   ..$ victim_last     : chr [1:210] "GRIFFIN" "WATERSON" "DANIELS" "BROWN" ...
    ##   ..$ victim_first    : chr [1:210] "DALLAS" "ELIZABETH LYNNE" "BRANT" "NORVEL" ...
    ##   ..$ victim_race     : chr [1:210] "Black" "White" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:210] 22 33 19 26 26 48 21 17 49 31 ...
    ##   ..$ victim_sex      : chr [1:210] "Male" "Female" "Male" "Male" ...
    ##   ..$ lat             : num [1:210] 36.7 36.8 36.8 36.7 36.8 ...
    ##   ..$ lon             : num [1:210] -120 -120 -120 -120 -120 ...
    ##   ..$ disposition     : chr [1:210] "Open/No arrest" "Closed without arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:210] "unresolved" "unresolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:210] 0 0 1 0 1 0 1 0 0 0 ...
    ##  $ : tibble [1,887 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:1887] "Hou-001783" "Hou-001784" "Hou-001786" "Hou-001789" ...
    ##   ..$ reported_date   : int [1:1887] 20070103 20070103 20070109 20070114 20070120 20070124 20070125 20070126 20070127 20070128 ...
    ##   ..$ victim_last     : chr [1:1887] "FISHER" "TAYLOR" "BRAWLEY" "MEYERS" ...
    ##   ..$ victim_first    : chr [1:1887] "MICHAEL" "OTIS" "JEREMY" "JAMAYA" ...
    ##   ..$ victim_race     : chr [1:1887] "White" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:1887] 48 42 28 23 30 NA 26 27 57 30 ...
    ##   ..$ victim_sex      : chr [1:1887] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:1887] 29.8 29.9 29.7 29.8 29.8 ...
    ##   ..$ lon             : num [1:1887] -95.4 -95.3 -95.6 -95.3 -95.5 ...
    ##   ..$ disposition     : chr [1:1887] "Closed by arrest" "Closed by arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:1887] "resolved" "resolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:1887] 1 1 1 1 1 0 1 1 1 1 ...
    ##  $ : tibble [1,237 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:1237] "Ind-000001" "Ind-000002" "Ind-000003" "Ind-000004" ...
    ##   ..$ reported_date   : int [1:1237] 20100320 20100129 20070102 20070108 20070111 20070111 20070113 20070122 20070125 20070127 ...
    ##   ..$ victim_last     : chr [1:1237] "DUNLAP" "PINKSTON" "MUNOZ" "PARHAM" ...
    ##   ..$ victim_first    : chr [1:1237] "GARY L" "MARK A" "ERIC" "JOYCE A" ...
    ##   ..$ victim_race     : chr [1:1237] "Black" "Black" "White" "Black" ...
    ##   ..$ victim_age      : num [1:1237] 21 35 27 59 19 47 52 58 36 34 ...
    ##   ..$ victim_sex      : chr [1:1237] "Male" "Male" "Male" "Female" ...
    ##   ..$ lat             : num [1:1237] 39.8 39.8 39.8 39.8 39.8 ...
    ##   ..$ lon             : num [1:1237] -86.2 -86.1 -86.1 -86.1 -86 ...
    ##   ..$ disposition     : chr [1:1237] "Open/No arrest" "Open/No arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:1237] "unresolved" "unresolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:1237] 0 0 1 0 0 1 0 0 0 1 ...
    ##  $ : tibble [1,138 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:1138] "Jac-000001" "Jac-000002" "Jac-000003" "Jac-000004" ...
    ##   ..$ reported_date   : int [1:1138] 20070105 20070105 20070106 20070106 20070108 20070111 20070111 20070111 20070123 20070123 ...
    ##   ..$ victim_last     : chr [1:1138] "NIXON" "TANKERSLEY" "SHROWDER" "SCHNOOR" ...
    ##   ..$ victim_first    : chr [1:1138] "ANGELA" "KEVIN" "PAMELA" "ERIC" ...
    ##   ..$ victim_race     : chr [1:1138] "Black" "Black" "White" "White" ...
    ##   ..$ victim_age      : num [1:1138] 46 19 37 43 52 53 58 57 19 38 ...
    ##   ..$ victim_sex      : chr [1:1138] "Female" "Male" "Female" "Male" ...
    ##   ..$ lat             : num [1:1138] 30.4 30.2 30.4 30.1 30.4 ...
    ##   ..$ lon             : num [1:1138] -81.7 -81.8 -81.7 -81.6 -81.5 ...
    ##   ..$ disposition     : chr [1:1138] "Open/No arrest" "Closed by arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:1138] "unresolved" "resolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:1138] 0 1 1 1 0 0 1 1 1 1 ...
    ##  $ : tibble [909 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:909] "Las-000001" "Las-000002" "Las-000003" "Las-000005" ...
    ##   ..$ reported_date   : int [1:909] 20070103 20070104 20070105 20070107 20070109 20070114 20070114 20070115 20070117 20070120 ...
    ##   ..$ victim_last     : chr [1:909] "PICKFORD" "AFSHARE" "HICKMAN" "TURNER" ...
    ##   ..$ victim_first    : chr [1:909] "NOEL" "ELHAM" "JAMAR" "ASHLEY" ...
    ##   ..$ victim_race     : chr [1:909] "Black" "White" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:909] 19 27 23 20 25 46 65 45 19 47 ...
    ##   ..$ victim_sex      : chr [1:909] "Male" "Female" "Male" "Female" ...
    ##   ..$ lat             : num [1:909] 36.2 36.1 36.2 36.2 36.2 ...
    ##   ..$ lon             : num [1:909] -115 -115 -115 -115 -115 ...
    ##   ..$ disposition     : chr [1:909] "Closed by arrest" "Open/No arrest" "Open/No arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:909] "resolved" "unresolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:909] 1 0 0 1 0 1 1 1 1 0 ...
    ##  $ : tibble [186 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:186] "Lon-000325" "Lon-000326" "Lon-000337" "Lon-000339" ...
    ##   ..$ reported_date   : int [1:186] 20070103 20070103 20070410 20070422 20070422 20070530 20070721 20070819 20070819 20070825 ...
    ##   ..$ victim_last     : chr [1:186] "SETTLES" "BROWN" "BURRIS" "MANDEVILLE" ...
    ##   ..$ victim_first    : chr [1:186] "TANYA" "TASHA" "KURYAKIN" "ERIC" ...
    ##   ..$ victim_race     : chr [1:186] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:186] 44 39 37 20 47 19 52 22 2 23 ...
    ##   ..$ victim_sex      : chr [1:186] "Female" "Female" "Male" "Male" ...
    ##   ..$ lat             : num [1:186] 33.8 33.8 33.9 33.8 33.8 ...
    ##   ..$ lon             : num [1:186] -118 -118 -118 -118 -118 ...
    ##   ..$ disposition     : chr [1:186] "Closed by arrest" "Closed by arrest" "Open/No arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:186] "resolved" "resolved" "unresolved" "unresolved" ...
    ##   ..$ resolved        : num [1:186] 1 1 0 0 1 1 1 0 0 1 ...
    ##  $ : tibble [1,078 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:1078] "Los-000001" "Los-000004" "Los-000005" "Los-000006" ...
    ##   ..$ reported_date   : int [1:1078] 20100416 20100505 20100624 20100719 20101212 20100306 20100314 20100624 20100207 20100207 ...
    ##   ..$ victim_last     : chr [1:1078] "Unknown" "Unknown" "Unknown" "Unknown" ...
    ##   ..$ victim_first    : chr [1:1078] "Unknown" "Unknown" "Unknown" "Unknown" ...
    ##   ..$ victim_race     : chr [1:1078] "Black" "White" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:1078] 41 65 64 35 40 21 29 27 45 23 ...
    ##   ..$ victim_sex      : chr [1:1078] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:1078] 34 34.1 34 34 34 ...
    ##   ..$ lon             : num [1:1078] -118 -118 -118 -118 -118 ...
    ##   ..$ disposition     : chr [1:1078] "Closed by arrest" "Open/No arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:1078] "resolved" "unresolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:1078] 1 0 1 0 1 0 1 1 0 0 ...
    ##  $ : tibble [550 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:550] "Lou-000001" "Lou-000002" "Lou-000003" "Lou-000004" ...
    ##   ..$ reported_date   : int [1:550] 20160106 20160109 20160113 20160120 20160120 20160120 20160120 20160204 20160205 20160213 ...
    ##   ..$ victim_last     : chr [1:550] "MORGAN" "ONEAL" "RUSSELL" "WILLIAMS" ...
    ##   ..$ victim_first    : chr [1:550] "MARC" "ANDRE" "TYLER" "AARON" ...
    ##   ..$ victim_race     : chr [1:550] "White" "Black" "White" "Black" ...
    ##   ..$ victim_age      : num [1:550] 38 8 15 26 37 35 35 50 63 36 ...
    ##   ..$ victim_sex      : chr [1:550] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:550] 38.1 38.3 38.3 38.2 38.2 ...
    ##   ..$ lon             : num [1:550] -85.9 -85.8 -85.8 -85.8 -85.8 ...
    ##   ..$ disposition     : chr [1:550] "Closed by arrest" "Closed by arrest" "Open/No arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:550] "resolved" "resolved" "unresolved" "unresolved" ...
    ##   ..$ resolved        : num [1:550] 1 1 0 0 1 0 1 1 0 1 ...
    ##  $ : tibble [1,421 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:1421] "Mem-000002" "Mem-000006" "Mem-000007" "Mem-000009" ...
    ##   ..$ reported_date   : int [1:1421] 20070105 20070110 20070112 20070113 20070125 20070129 20070129 20070202 20070203 20070212 ...
    ##   ..$ victim_last     : chr [1:1421] "SIMS" "CALHOUN" "COTTON" "BOWNES" ...
    ##   ..$ victim_first    : chr [1:1421] "JAMES" "JULIUS" "ANDRE" "MARTHA" ...
    ##   ..$ victim_race     : chr [1:1421] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:1421] 28 18 34 24 21 42 0 24 29 30 ...
    ##   ..$ victim_sex      : chr [1:1421] "Male" "Male" "Male" "Female" ...
    ##   ..$ lat             : num [1:1421] 35 35.2 35.2 35.2 35.1 ...
    ##   ..$ lon             : num [1:1421] -90 -90 -90 -89.9 -90.1 ...
    ##   ..$ disposition     : chr [1:1421] "Closed by arrest" "Closed by arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:1421] "resolved" "resolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:1421] 1 1 1 1 0 1 1 1 1 0 ...
    ##  $ : tibble [438 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:438] "Mia-000295" "Mia-000296" "Mia-000297" "Mia-000298" ...
    ##   ..$ reported_date   : int [1:438] 20110307 20110308 20110321 20110905 20110829 20110127 20110424 20111016 20110918 20111201 ...
    ##   ..$ victim_last     : chr [1:438] "LOWE" "BAIN" "KYLES" "SIMS" ...
    ##   ..$ victim_first    : chr [1:438] "ANDRAE" "KEVAR" "KENNETH L" "MELVIN" ...
    ##   ..$ victim_race     : chr [1:438] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:438] NA 30 24 48 56 2 4 38 26 16 ...
    ##   ..$ victim_sex      : chr [1:438] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:438] 25.8 25.8 25.8 25.8 25.8 ...
    ##   ..$ lon             : num [1:438] -80.2 -80.2 -80.2 -80.2 -80.2 ...
    ##   ..$ disposition     : chr [1:438] "Open/No arrest" "Open/No arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:438] "unresolved" "unresolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:438] 0 0 1 1 1 1 1 0 0 0 ...
    ##  $ : tibble [994 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:994] "Mil-000001" "Mil-000003" "Mil-000004" "Mil-000005" ...
    ##   ..$ reported_date   : int [1:994] 20130819 20090928 20130408 20101231 20140218 20151003 20140309 20110629 20121002 20150601 ...
    ##   ..$ victim_last     : chr [1:994] "TYSZKO" "HARRIS" "BAUTCH" "CHRISTENSON-SUKKERT" ...
    ##   ..$ victim_first    : chr [1:994] "DEBRA" "DEREK" "ANNEMARIE" "ANGELA" ...
    ##   ..$ victim_race     : chr [1:994] "White" "White" "White" "White" ...
    ##   ..$ victim_age      : num [1:994] 59 22 39 40 41 33 1 34 24 3 ...
    ##   ..$ victim_sex      : chr [1:994] "Female" "Male" "Female" "Female" ...
    ##   ..$ lat             : num [1:994] 42.9 43 43 43 43 ...
    ##   ..$ lon             : num [1:994] -87.9 -87.9 -87.9 -87.9 -88 ...
    ##   ..$ disposition     : chr [1:994] "Closed without arrest" "Closed by arrest" "Closed without arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:994] "unresolved" "resolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:994] 0 1 0 1 1 1 1 1 1 1 ...
    ##  $ : tibble [299 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:299] "Min-000001" "Min-000002" "Min-000005" "Min-000010" ...
    ##   ..$ reported_date   : int [1:299] 20160101 20070101 20100102 20070107 20100108 20170107 20170108 20110111 20070112 20070115 ...
    ##   ..$ victim_last     : chr [1:299] "BILLS" "HOLLIDAY" "JOHNSON" "WILEY" ...
    ##   ..$ victim_first    : chr [1:299] "JAMES EDWARD" "DANIEL MICHAEL" "DONTAE DESHUN" "JERRY DIALLO" ...
    ##   ..$ victim_race     : chr [1:299] "Black" "White" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:299] 20 23 31 27 19 30 35 44 30 34 ...
    ##   ..$ victim_sex      : chr [1:299] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:299] 45 45 45 45 44.9 ...
    ##   ..$ lon             : num [1:299] -93.2 -93.3 -93.3 -93.3 -93.3 ...
    ##   ..$ disposition     : chr [1:299] "Open/No arrest" "Closed by arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:299] "unresolved" "resolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:299] 0 1 1 0 0 0 0 1 0 1 ...
    ##  $ : tibble [746 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:746] "Nas-000001" "Nas-000002" "Nas-000003" "Nas-000004" ...
    ##   ..$ reported_date   : int [1:746] 20070105 20070105 20070107 20070107 20070114 20070119 20070208 20070216 20070227 20070302 ...
    ##   ..$ victim_last     : chr [1:746] "TAYLOR" "BOND" "BAKER" "HALL" ...
    ##   ..$ victim_first    : chr [1:746] "TARIKA S" "SHERRI L" "NAKIA L" "WILLIAM A" ...
    ##   ..$ victim_race     : chr [1:746] "Black" "Black" "Black" "White" ...
    ##   ..$ victim_age      : num [1:746] 25 23 32 25 26 24 67 0 49 24 ...
    ##   ..$ victim_sex      : chr [1:746] "Female" "Female" "Male" "Male" ...
    ##   ..$ lat             : num [1:746] 36.1 36.2 36.1 36.1 36.2 ...
    ##   ..$ lon             : num [1:746] -86.9 -86.8 -86.7 -86.7 -86.8 ...
    ##   ..$ disposition     : chr [1:746] "Closed without arrest" "Closed by arrest" "Open/No arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:746] "unresolved" "resolved" "unresolved" "unresolved" ...
    ##   ..$ resolved        : num [1:746] 0 1 0 0 1 1 0 1 1 1 ...
    ##  $ : tibble [1,353 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:1353] "NO-000006" "NO-000007" "NO-000008" "NO-000009" ...
    ##   ..$ reported_date   : int [1:1353] 20080502 20081025 20090321 20091116 20100103 20100104 20100107 20100107 20100107 20100109 ...
    ##   ..$ victim_last     : chr [1:1353] "CAIN" "JURY" "DAVIS" "DEVILLENEUDE" ...
    ##   ..$ victim_first    : chr [1:1353] "STANFORD" "KENDALL" "RUFUS III" "JUSTIN" ...
    ##   ..$ victim_race     : chr [1:1353] "Black" "Black" "Black" "White" ...
    ##   ..$ victim_age      : num [1:1353] 23 21 33 21 28 21 30 25 37 25 ...
    ##   ..$ victim_sex      : chr [1:1353] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:1353] 30 29.9 30 30 30 ...
    ##   ..$ lon             : num [1:1353] -90.1 -90.1 -90 -90.1 -90.1 ...
    ##   ..$ disposition     : chr [1:1353] "Closed by arrest" "Closed without arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:1353] "resolved" "unresolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:1353] 1 0 1 0 1 1 1 1 1 0 ...
    ##  $ : tibble [412 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:412] "NY-000003" "NY-000004" "NY-000005" "NY-000006" ...
    ##   ..$ reported_date   : int [1:412] 20160104 20160106 20160109 20160110 20160110 20160111 20160111 20160113 20160114 20160117 ...
    ##   ..$ victim_last     : chr [1:412] "Unknown" "Unknown" "Unknown" "Unknown" ...
    ##   ..$ victim_first    : chr [1:412] "Unknown" "Unknown" "Unknown" "Unknown" ...
    ##   ..$ victim_race     : chr [1:412] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:412] 39 27 25 29 33 44 34 18 43 37 ...
    ##   ..$ victim_sex      : chr [1:412] "Female" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:412] 40.9 40.7 40.7 40.7 40.7 ...
    ##   ..$ lon             : num [1:412] -73.8 -73.9 -73.9 -73.9 -74 ...
    ##   ..$ disposition     : chr [1:412] "Closed by arrest" "Open/No arrest" "Open/No arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:412] "resolved" "unresolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:412] 1 0 0 1 0 1 1 1 1 0 ...
    ##  $ : tibble [740 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:740] "Oak-000001" "Oak-000003" "Oak-000004" "Oak-000007" ...
    ##   ..$ reported_date   : int [1:740] 20080731 20090207 20101010 20130816 20120204 20101221 20170919 20110615 20111101 20101105 ...
    ##   ..$ victim_last     : chr [1:740] "WELLS" "DOUGLAS" "PRATER" "GONZALEZ" ...
    ##   ..$ victim_first    : chr [1:740] "DAVID" "WILLIAM B." "TRENT" "BRYAN" ...
    ##   ..$ victim_race     : chr [1:740] "White" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:740] 62 57 52 19 30 21 26 30 32 45 ...
    ##   ..$ victim_sex      : chr [1:740] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:740] 37.7 37.7 37.7 37.7 37.7 ...
    ##   ..$ lon             : num [1:740] -122 -122 -122 -122 -122 ...
    ##   ..$ disposition     : chr [1:740] "Closed by arrest" "Open/No arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:740] "resolved" "unresolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:740] 1 0 1 1 1 0 1 0 0 1 ...
    ##  $ : tibble [522 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:522] "Okl-000002" "Okl-000003" "Okl-000004" "Okl-000005" ...
    ##   ..$ reported_date   : int [1:522] 20070113 20070125 20070208 20070211 20070211 20070212 20070220 20070309 20070307 20070316 ...
    ##   ..$ victim_last     : chr [1:522] "BLANTON" "WAGONER" "LUCAS" "FORREST" ...
    ##   ..$ victim_first    : chr [1:522] "ALAN JOSEPH" "TIMOTHY DEWAYNE" "GREGORY" "CINDY S" ...
    ##   ..$ victim_race     : chr [1:522] "White" "White" "Black" "White" ...
    ##   ..$ victim_age      : num [1:522] 27 25 20 43 39 36 35 25 6 19 ...
    ##   ..$ victim_sex      : chr [1:522] "Male" "Male" "Male" "Female" ...
    ##   ..$ lat             : num [1:522] 35.5 35.6 35.4 35.5 35.4 ...
    ##   ..$ lon             : num [1:522] -97.6 -97.5 -97.6 -97.6 -97.3 ...
    ##   ..$ disposition     : chr [1:522] "Open/No arrest" "Open/No arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:522] "unresolved" "unresolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:522] 0 0 1 1 1 1 1 1 1 1 ...
    ##  $ : tibble [365 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:365] "Oma-000001" "Oma-000003" "Oma-000004" "Oma-000005" ...
    ##   ..$ reported_date   : int [1:365] 20090102 20090122 20090308 20090311 20090330 20090405 20090614 20090615 20090704 20090712 ...
    ##   ..$ victim_last     : chr [1:365] "PIERCE" "BARGES" "DEVERS" "HOLMES" ...
    ##   ..$ victim_first    : chr [1:365] "LAURA" "PETER" "ARIUS" "GARY" ...
    ##   ..$ victim_race     : chr [1:365] "White" "White" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:365] 42 39 21 22 NA 45 54 16 18 37 ...
    ##   ..$ victim_sex      : chr [1:365] "Female" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:365] 41.2 41.3 41.3 41.3 41.3 ...
    ##   ..$ lon             : num [1:365] -96 -96 -96 -96 -96 ...
    ##   ..$ disposition     : chr [1:365] "Closed by arrest" "Closed by arrest" "Open/No arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:365] "resolved" "resolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:365] 1 1 0 1 1 1 0 0 0 0 ...
    ##  $ : tibble [2,615 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:2615] "Phi-000001" "Phi-000002" "Phi-000003" "Phi-000004" ...
    ##   ..$ reported_date   : int [1:2615] 20160904 20161224 20150730 20160703 20160820 20160721 20160616 20161012 20170101 20161224 ...
    ##   ..$ victim_last     : chr [1:2615] "LEWIS" "ALEXANDER" "DZIKOWSKI" "CLARK" ...
    ##   ..$ victim_first    : chr [1:2615] "MAULUI" "JAQUAN" "STEPHANIE" "CHARLES" ...
    ##   ..$ victim_race     : chr [1:2615] "Black" "Black" "White" "Black" ...
    ##   ..$ victim_age      : num [1:2615] 45 17 22 37 25 48 21 22 41 81 ...
    ##   ..$ victim_sex      : chr [1:2615] "Male" "Male" "Female" "Male" ...
    ##   ..$ lat             : num [1:2615] 40 39.9 40 40 40 ...
    ##   ..$ lon             : num [1:2615] -75.1 -75.2 -75.1 -75.1 -75.2 ...
    ##   ..$ disposition     : chr [1:2615] "Closed by arrest" "Closed by arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:2615] "resolved" "resolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:2615] 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ : tibble [623 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:623] "Pit-000002" "Pit-000003" "Pit-000005" "Pit-000009" ...
    ##   ..$ reported_date   : int [1:623] 20100820 20160909 20120909 20130402 20141209 20080720 20150909 20141005 20080326 20110805 ...
    ##   ..$ victim_last     : chr [1:623] "JOHNSON" "CABBAGSTALK" "WOFFORD" "JONES" ...
    ##   ..$ victim_first    : chr [1:623] "ALAN" "DOMANEK" "LEROY" "DWAN" ...
    ##   ..$ victim_race     : chr [1:623] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:623] 73 25 59 42 0 21 14 18 6 19 ...
    ##   ..$ victim_sex      : chr [1:623] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:623] 40.4 40.4 40.5 40.5 40.4 ...
    ##   ..$ lon             : num [1:623] -80 -80.1 -79.9 -79.9 -80 ...
    ##   ..$ disposition     : chr [1:623] "Closed by arrest" "Open/No arrest" "Open/No arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:623] "resolved" "unresolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:623] 1 0 0 1 1 0 0 1 1 0 ...
    ##  $ : tibble [408 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:408] "Ric-000001" "Ric-000002" "Ric-000003" "Ric-000005" ...
    ##   ..$ reported_date   : int [1:408] 20100112 20100112 20100122 20100128 20100307 20100310 20100401 20100401 20100402 20100402 ...
    ##   ..$ victim_last     : chr [1:408] "SCOTT" "MOORE" "RANDOLPH" "SMITH" ...
    ##   ..$ victim_first    : chr [1:408] "TRACY" "ANGELA" "BRITTNEY" "SHAWN" ...
    ##   ..$ victim_race     : chr [1:408] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:408] 41 42 20 26 34 26 38 26 36 58 ...
    ##   ..$ victim_sex      : chr [1:408] "Male" "Female" "Female" "Male" ...
    ##   ..$ lat             : num [1:408] 37.5 37.5 37.5 37.5 37.6 ...
    ##   ..$ lon             : num [1:408] -77.5 -77.5 -77.5 -77.4 -77.4 ...
    ##   ..$ disposition     : chr [1:408] "Open/No arrest" "Open/No arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:408] "unresolved" "unresolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:408] 0 0 1 0 1 0 1 1 0 0 ...
    ##  $ : tibble [236 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:236] "Sac-000307" "Sac-000308" "Sac-000309" "Sac-000310" ...
    ##   ..$ reported_date   : int [1:236] 20070102 20070105 20070105 20070111 20070117 20070206 20070215 20070309 20070323 20070324 ...
    ##   ..$ victim_last     : chr [1:236] "Unknown" "Unknown" "Unknown" "Unknown" ...
    ##   ..$ victim_first    : chr [1:236] "Unknown" "Unknown" "Unknown" "Unknown" ...
    ##   ..$ victim_race     : chr [1:236] "Black" "Black" "Black" "White" ...
    ##   ..$ victim_age      : num [1:236] 26 30 23 61 17 17 19 27 17 36 ...
    ##   ..$ victim_sex      : chr [1:236] "Male" "Female" "Male" "Male" ...
    ##   ..$ lat             : num [1:236] 38.6 38.5 38.5 38.6 38.5 ...
    ##   ..$ lon             : num [1:236] -121 -121 -121 -121 -121 ...
    ##   ..$ disposition     : chr [1:236] "Closed by arrest" "Closed by arrest" "Open/No arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:236] "resolved" "resolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:236] 1 1 0 1 1 0 1 1 1 1 ...
    ##  $ : tibble [310 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:310] "SA-000007" "SA-000008" "SA-000009" "SA-000011" ...
    ##   ..$ reported_date   : int [1:310] 20080127 20080206 20080208 20080218 20080227 20080326 20080404 20080410 20080412 20080515 ...
    ##   ..$ victim_last     : chr [1:310] "PRATT" "MCQUEEN" "DUNCAN" "Unknown" ...
    ##   ..$ victim_first    : chr [1:310] "BRANDON" "T.L." "CHRISTOPHER" "Unknown" ...
    ##   ..$ victim_race     : chr [1:310] "Black" "Black" "White" "Black" ...
    ##   ..$ victim_age      : num [1:310] 27 22 23 13 68 35 47 22 26 40 ...
    ##   ..$ victim_sex      : chr [1:310] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:310] 29.5 29.4 29.3 29.4 29.3 ...
    ##   ..$ lon             : num [1:310] -98.4 -98.5 -98.4 -98.5 -98.5 ...
    ##   ..$ disposition     : chr [1:310] "Open/No arrest" "Closed by arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:310] "unresolved" "resolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:310] 0 1 1 0 1 1 1 0 0 1 ...
    ##  $ : tibble [152 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:152] "SB-000001" "SB-000006" "SB-000007" "SB-000008" ...
    ##   ..$ reported_date   : int [1:152] 20160127 20160620 20160625 20160708 20160708 20160708 20160720 20160920 20161122 20170312 ...
    ##   ..$ victim_last     : chr [1:152] "HOLMES" "MITCHELL" "BOYKINS" "MAHAN" ...
    ##   ..$ victim_first    : chr [1:152] "ROCKY" "CURTIS" "CALVIN" "SAMATHY" ...
    ##   ..$ victim_race     : chr [1:152] "White" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:152] 49 31 30 25 9 26 21 39 37 50 ...
    ##   ..$ victim_sex      : chr [1:152] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:152] 34.1 34.1 34.1 34.1 34.1 ...
    ##   ..$ lon             : num [1:152] -117 -117 -117 -117 -117 ...
    ##   ..$ disposition     : chr [1:152] "Closed by arrest" "Closed by arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:152] "resolved" "resolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:152] 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ : tibble [272 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:272] "SD-000003" "SD-000006" "SD-000009" "SD-000010" ...
    ##   ..$ reported_date   : int [1:272] 20070126 20070226 20070318 20070320 20070408 20070424 20070424 20070428 20070507 20070528 ...
    ##   ..$ victim_last     : chr [1:272] "HARPER" "HAWES" "FOTINOS" "GREEN" ...
    ##   ..$ victim_first    : chr [1:272] "GREGORY WALTER" "ALLEN B" "BRADLEY REX" "DAMON L" ...
    ##   ..$ victim_race     : chr [1:272] "Black" "White" "White" "Black" ...
    ##   ..$ victim_age      : num [1:272] 25 57 56 38 59 50 51 51 38 44 ...
    ##   ..$ victim_sex      : chr [1:272] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:272] 32.7 32.6 32.7 32.8 32.7 ...
    ##   ..$ lon             : num [1:272] -117 -117 -117 -117 -117 ...
    ##   ..$ disposition     : chr [1:272] "Closed by arrest" "Closed by arrest" "Open/No arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:272] "resolved" "resolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:272] 1 1 0 1 1 1 1 1 1 1 ...
    ##  $ : tibble [462 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:462] "SF-000001" "SF-000002" "SF-000003" "SF-000005" ...
    ##   ..$ reported_date   : int [1:462] 20070101 20070101 20070102 20070107 20070112 20070114 20070114 20070127 20070131 20070211 ...
    ##   ..$ victim_last     : chr [1:462] "BABERS" "MINOR" "LATTMAN" "SCOTT" ...
    ##   ..$ victim_first    : chr [1:462] "KENNETH" "GEORGE" "HANS HENRY" "TIMOTHY" ...
    ##   ..$ victim_race     : chr [1:462] "Black" "Black" "White" "Black" ...
    ##   ..$ victim_age      : num [1:462] 43 50 76 25 49 20 21 20 31 24 ...
    ##   ..$ victim_sex      : chr [1:462] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:462] 37.7 37.7 37.7 37.8 37.7 ...
    ##   ..$ lon             : num [1:462] -122 -122 -122 -122 -122 ...
    ##   ..$ disposition     : chr [1:462] "Closed by arrest" "Open/No arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:462] "resolved" "unresolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:462] 1 0 1 0 1 0 0 1 0 0 ...
    ##  $ : tibble [231 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:231] "Sav-000087" "Sav-000088" "Sav-000089" "Sav-000091" ...
    ##   ..$ reported_date   : int [1:231] 20070124 20070303 20070305 20070410 20070427 20070516 20070529 20070630 20070706 20070912 ...
    ##   ..$ victim_last     : chr [1:231] "WILLIAMS" "BIGGINS" "CHOISNET" "OSBORNE" ...
    ##   ..$ victim_first    : chr [1:231] "TRINITY" "ASHLEY M" "FRED E SR" "MIQUEL" ...
    ##   ..$ victim_race     : chr [1:231] "Black" "Black" "White" "Black" ...
    ##   ..$ victim_age      : num [1:231] NA 22 83 24 23 52 30 45 36 43 ...
    ##   ..$ victim_sex      : chr [1:231] "Female" "Female" "Male" "Male" ...
    ##   ..$ lat             : num [1:231] 32 32.1 32 32 32.1 ...
    ##   ..$ lon             : num [1:231] -81.1 -81.1 -81.1 -81.2 -81.1 ...
    ##   ..$ disposition     : chr [1:231] "Closed by arrest" "Closed by arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:231] "resolved" "resolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:231] 1 1 1 0 0 1 1 1 1 1 ...
    ##  $ : tibble [1,645 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:1645] "StL-000744" "StL-000745" "StL-000746" "StL-000747" ...
    ##   ..$ reported_date   : int [1:1645] 20070501 20070710 20070102 20070104 20070107 20070107 20070117 20070120 20070121 20070121 ...
    ##   ..$ victim_last     : chr [1:1645] "JOHNSON" "BARKSDALE" "RICHARDSON" "ARNETT" ...
    ##   ..$ victim_first    : chr [1:1645] "DARRELL" "ANTWON" "JARVIS" "TERRENCE M" ...
    ##   ..$ victim_race     : chr [1:1645] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:1645] 18 31 33 32 17 32 52 20 38 24 ...
    ##   ..$ victim_sex      : chr [1:1645] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:1645] 38.7 38.5 38.7 38.7 38.7 ...
    ##   ..$ lon             : num [1:1645] -90.2 -90.3 -90.3 -90.2 -90.2 ...
    ##   ..$ disposition     : chr [1:1645] "Closed by arrest" "Open/No arrest" "Closed by arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:1645] "resolved" "unresolved" "resolved" "unresolved" ...
    ##   ..$ resolved        : num [1:1645] 1 0 1 0 1 0 1 1 1 0 ...
    ##  $ : tibble [191 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:191] "Sto-000002" "Sto-000003" "Sto-000004" "Sto-000006" ...
    ##   ..$ reported_date   : int [1:191] 20070102 20070102 20070106 20070128 20070228 20070525 20070717 20070726 20071006 20071014 ...
    ##   ..$ victim_last     : chr [1:191] "Unknown" "Unknown" "Unknown" "Unknown" ...
    ##   ..$ victim_first    : chr [1:191] "Unknown" "Unknown" "Unknown" "Unknown" ...
    ##   ..$ victim_race     : chr [1:191] "Black" "White" "White" "White" ...
    ##   ..$ victim_age      : num [1:191] 52 0 27 30 16 51 39 53 36 44 ...
    ##   ..$ victim_sex      : chr [1:191] "Male" "Female" "Male" "Female" ...
    ##   ..$ lat             : num [1:191] 37.9 38 38 38 38 ...
    ##   ..$ lon             : num [1:191] -121 -121 -121 -121 -121 ...
    ##   ..$ disposition     : chr [1:191] "Closed by arrest" "Closed by arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:191] "resolved" "resolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:191] 1 1 1 1 1 0 1 1 1 0 ...
    ##  $ : tibble [187 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:187] "Tam-000001" "Tam-000002" "Tam-000003" "Tam-000004" ...
    ##   ..$ reported_date   : int [1:187] 20100102 20100205 20100217 20100316 20100327 20100402 20100407 20100414 20100518 20100531 ...
    ##   ..$ victim_last     : chr [1:187] "WALL" "DARKINS" "WILSON" "MOWREY" ...
    ##   ..$ victim_first    : chr [1:187] "ANNIE R." "RYAN JERARD" "LEROY D." "LISA ANNE" ...
    ##   ..$ victim_race     : chr [1:187] "Black" "Black" "Black" "White" ...
    ##   ..$ victim_age      : num [1:187] 61 21 21 24 23 52 56 50 21 42 ...
    ##   ..$ victim_sex      : chr [1:187] "Female" "Male" "Male" "Female" ...
    ##   ..$ lat             : num [1:187] 28 28 28 28.1 28 ...
    ##   ..$ lon             : num [1:187] -82.4 -82.4 -82.4 -82.4 -82.5 ...
    ##   ..$ disposition     : chr [1:187] "Closed by arrest" "Closed by arrest" "Open/No arrest" "Open/No arrest" ...
    ##   ..$ disposition_case: chr [1:187] "resolved" "resolved" "unresolved" "unresolved" ...
    ##   ..$ resolved        : num [1:187] 1 1 0 0 1 0 1 0 1 1 ...
    ##  $ : tibble [515 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:515] "Tul-000173" "Tul-000174" "Tul-000175" "Tul-000176" ...
    ##   ..$ reported_date   : int [1:515] 20070101 20070105 20070110 20070117 20070123 20070123 20070123 20070124 20070127 20070202 ...
    ##   ..$ victim_last     : chr [1:515] "DEATHERAGE" "REDACTED" "KIKUGAWA" "HERNANDEZKIKUGA" ...
    ##   ..$ victim_first    : chr [1:515] "CHERYL" "REDACTED" "ALETHEIA" "FETUS" ...
    ##   ..$ victim_race     : chr [1:515] "White" "Black" "White" "White" ...
    ##   ..$ victim_age      : num [1:515] 56 0 33 NA 46 40 38 26 25 51 ...
    ##   ..$ victim_sex      : chr [1:515] "Female" "Male" "Female" "Male" ...
    ##   ..$ lat             : num [1:515] 36.1 36.1 36.1 36.1 36.2 ...
    ##   ..$ lon             : num [1:515] -96 -95.9 -95.9 -95.9 -95.9 ...
    ##   ..$ disposition     : chr [1:515] "Closed by arrest" "Closed by arrest" "Closed by arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:515] "resolved" "resolved" "resolved" "resolved" ...
    ##   ..$ resolved        : num [1:515] 1 1 1 1 0 1 1 1 0 1 ...
    ##  $ : tibble [1,259 × 12] (S3: tbl_df/tbl/data.frame)
    ##   ..$ uid             : chr [1:1259] "Was-000001" "Was-000002" "Was-000004" "Was-000005" ...
    ##   ..$ reported_date   : int [1:1259] 20150103 20150108 20150111 20150111 20150114 20150119 20150125 20150203 20150204 20150210 ...
    ##   ..$ victim_last     : chr [1:1259] "ROSS" "STEWART" "NEWMAN" "ANDERSON" ...
    ##   ..$ victim_first    : chr [1:1259] "RAHJI" "MARVIN" "ANDREW" "JAMES" ...
    ##   ..$ victim_race     : chr [1:1259] "Black" "Black" "Black" "Black" ...
    ##   ..$ victim_age      : num [1:1259] 35 49 17 27 17 22 45 19 46 30 ...
    ##   ..$ victim_sex      : chr [1:1259] "Male" "Male" "Male" "Male" ...
    ##   ..$ lat             : num [1:1259] 38.9 38.9 38.9 38.9 38.8 ...
    ##   ..$ lon             : num [1:1259] -77 -77 -77 -77 -77 ...
    ##   ..$ disposition     : chr [1:1259] "Open/No arrest" "Closed by arrest" "Open/No arrest" "Closed by arrest" ...
    ##   ..$ disposition_case: chr [1:1259] "unresolved" "resolved" "unresolved" "resolved" ...
    ##   ..$ resolved        : num [1:1259] 0 1 0 1 0 1 0 1 1 1 ...

``` r
# Function to run logistic regression and extract OR and CI
run_logistic <- function(data) {
  fit <- glm(resolved ~ victim_age + victim_race + victim_sex, data = data, family = binomial())
  tidy_fit <- tidy(fit, conf.int = TRUE) %>%
    mutate(
      OR = exp(estimate),
      OR_conf.low = exp(conf.low),
      OR_conf.high = exp(conf.high)
    ) %>%
    filter(term == "victim_sexMale") %>%
    select(term, log_OR = estimate, OR, p.value, OR_conf.low, OR_conf.high)
  return(tidy_fit)
}

# Apply the function to each city's data and unnest the results
results <- nested_data %>%
  mutate(model = purrr::map(data, run_logistic)) %>%
  unnest(model) %>% 
    select (OR, OR_conf.low, OR_conf.high) %>% 
  rename(Low = "OR_conf.low",
          High = "OR_conf.high") 
```

    ## Warning: There were 45 warnings in `mutate()`.
    ## The first warning was:
    ## ℹ In argument: `model = purrr::map(data, run_logistic)`.
    ## ℹ In group 1: `city_state = "Albuquerque,NM"`.
    ## Caused by warning:
    ## ! glm.fit: fitted probabilities numerically 0 or 1 occurred
    ## ℹ Run `dplyr::last_dplyr_warnings()` to see the 44 remaining warnings.

    ## Adding missing grouping variables: `city_state`

``` r
# Display the results
results %>% knitr::kable(digits = 2)
```

| city_state        |   OR |  Low | High |
|:------------------|-----:|-----:|-----:|
| Albuquerque,NM    | 1.77 | 0.82 | 3.76 |
| Atlanta,GA        | 1.00 | 0.68 | 1.46 |
| Baltimore,MD      | 0.43 | 0.32 | 0.56 |
| Baton Rouge,LA    | 0.38 | 0.20 | 0.68 |
| Birmingham,AL     | 0.87 | 0.57 | 1.31 |
| Boston,MA         | 0.67 | 0.35 | 1.28 |
| Buffalo,NY        | 0.52 | 0.29 | 0.94 |
| Charlotte,NC      | 0.88 | 0.55 | 1.39 |
| Chicago,IL        | 0.41 | 0.34 | 0.50 |
| Cincinnati,OH     | 0.40 | 0.23 | 0.67 |
| Columbus,OH       | 0.53 | 0.38 | 0.75 |
| Denver,CO         | 0.48 | 0.23 | 0.96 |
| Detroit,MI        | 0.58 | 0.46 | 0.73 |
| Durham,NC         | 0.81 | 0.38 | 1.66 |
| Fort Worth,TX     | 0.67 | 0.39 | 1.12 |
| Fresno,CA         | 1.34 | 0.57 | 3.05 |
| Houston,TX        | 0.71 | 0.56 | 0.91 |
| Indianapolis,IN   | 0.92 | 0.68 | 1.24 |
| Jacksonville,FL   | 0.72 | 0.54 | 0.97 |
| Las Vegas,NV      | 0.84 | 0.61 | 1.15 |
| Long Beach,CA     | 0.41 | 0.14 | 1.02 |
| Los Angeles,CA    | 0.66 | 0.46 | 0.95 |
| Louisville,KY     | 0.49 | 0.30 | 0.78 |
| Memphis,TN        | 0.72 | 0.53 | 0.98 |
| Miami,FL          | 0.52 | 0.30 | 0.87 |
| Milwaukee,wI      | 0.73 | 0.50 | 1.05 |
| Minneapolis,MN    | 0.95 | 0.48 | 1.88 |
| Nashville,TN      | 1.03 | 0.68 | 1.56 |
| New Orleans,LA    | 0.58 | 0.42 | 0.81 |
| New York,NY       | 0.26 | 0.13 | 0.49 |
| Oakland,CA        | 0.56 | 0.36 | 0.87 |
| Oklahoma City,OK  | 0.97 | 0.62 | 1.52 |
| Omaha,NE          | 0.38 | 0.20 | 0.71 |
| Philadelphia,PA   | 0.50 | 0.38 | 0.65 |
| Pittsburgh,PA     | 0.43 | 0.26 | 0.70 |
| Richmond,VA       | 1.01 | 0.48 | 1.99 |
| San Antonio,TX    | 0.70 | 0.39 | 1.24 |
| Sacramento,CA     | 0.67 | 0.33 | 1.31 |
| Savannah,GA       | 0.87 | 0.42 | 1.78 |
| San Bernardino,CA | 0.50 | 0.17 | 1.46 |
| San Diego,CA      | 0.41 | 0.19 | 0.83 |
| San Francisco,CA  | 0.61 | 0.31 | 1.16 |
| St. Louis,MO      | 0.70 | 0.53 | 0.93 |
| Stockton,CA       | 1.35 | 0.63 | 2.99 |
| Tampa,FL          | 0.81 | 0.34 | 1.86 |
| Tulsa,OK          | 0.98 | 0.61 | 1.54 |
| Washington,DC     | 0.69 | 0.47 | 1.01 |

# Problem 3
